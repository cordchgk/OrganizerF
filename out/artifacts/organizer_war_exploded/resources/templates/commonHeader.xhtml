<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"

      xmlns:p="http://primefaces.org/ui">

<ui:composition>
    <script type="text/javascript">

        function myFunction() {

            var popup = document.getElementById("myPopup");
            document.getElementById('myPopup').contentWindow.location.reload(true);

            popup.focus();
            popup.classList.toggle("show");


        }

        function socketListener(message, channel, event) {

            var m = "message:" + message + ", channel:" + channel + ", event:" + event;
            console.log(m);
            document.getElementById('nots').innerHTML = message;


        }



    </script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <header style="background-color: #8a6642 " class="ci">
        <h1 style="font-size: 2.5em"><a href="#{facesContext.externalContext.requestContextPath}">Organize It</a></h1>
        <ul class="navbar">

            <h:panelGroup rendered="#{!user.isAuthenticated()}">
                <li>
                    <h:link styleClass="login waves-effect btn-flat"
                            value="LOGIN"
                            outcome="/user/login.xhtml"/>
                </li>
                <li>
                    <h:link styleClass="login waves-effect btn-flat"
                            value="Registration"
                            outcome="/user/registration.xhtml"/>
                </li>

            </h:panelGroup>
            <h:panelGroup rendered="#{user.isAuthenticated()}">
                <li>

                   <f:websocket channel="testChannel" onmessage="socketListener" >




                   </f:websocket>
                    <p:outputLabel id="nots" value="#{headerB.notifications}" binding="#{headerB.uiComponent}">

                    </p:outputLabel>

                </li>
                <li>


                    <div class="popup" onclick="myFunction()">Notifications

                        <iframe allowtransparency="false" id="myPopup" class="popuptext login card-no-hover"
                                src="#{headerB.url}/user/notifications.xhtml"
                                height="600"
                                style="width: 500px" name="Notifications">

                        </iframe>


                    </div>


                    <!--    <h:link styleClass="profile waves-effect btn-flat"
                                value="Notifications"
                                outcome="/user/notifications.xhtml"/>
    -->
                </li>
                <li>
                    <h:link styleClass="profile waves-effect btn-flat"
                            value="My Groups"
                            outcome="/group/groups.xhtml"/>

                </li>
                <li>
                    <h:link styleClass="profile waves-effect btn-flat"
                            value="Profile"
                            outcome="/user/profile.xhtml"/>

                </li>

                <li>
                    <h:form>
                        <h:commandLink
                                styleClass="logout waves-effect btn-flat"
                                value="LOGOUT"
                                action="#{user.logout()}">
                        </h:commandLink>
                    </h:form>
                </li>
            </h:panelGroup>
        </ul>

    </header>

</ui:composition>

</html>
