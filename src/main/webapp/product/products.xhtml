<ui:composition template="/resources/templates/commonLayout.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core">

    <f:metadata>
        <f:viewParam name="gID" value="#{group.ID}"/>
    </f:metadata>


    <ui:define name="title">Products</ui:define>
    <ui:define name="content">
        <f:event listener="#{product.isAllowed()}" type="preRenderView"/>


        <div class="card-no-hover" style="width: 50%;height:auto;margin: auto;margin-top: 10%">


            <h:form id="form">
                <h:dataTable id="table" columnClasses="column" style="width: 100%"
                             var="p" width="100" value="#{product.productModel}">
                    <h:column>
                        <f:facet name="header">Name</f:facet>
                        <div style="text-align: center">
                            #{p.name}
                        </div>


                    </h:column>
                    <h:column>
                        <f:facet name="header">Stock</f:facet>
                        <div style="text-align: center">
                            #{p.count}
                        </div>
                    </h:column>
                    <h:column>
                        <f:facet name="header">Decrease</f:facet>
                        <div style="text-align: center">
                            <h:commandButton rendered="#{product.rendered()}" value="-"
                                             action="#{product.dec()}">
                                <f:ajax execute="form" render="form"/>
                            </h:commandButton>
                        </div>
                    </h:column>
                    <h:column>
                        <f:facet name="">Name</f:facet>
                        <div style="text-align: center">
                            <h:inputText validator="#{product.validate}"
                                         onkeypress="if (event.keyCode === 13){event.preventDefault()}" id="input"
                                         size="2"
                                         value="#{p.diff}" converterMessage="Must be an Integer!">
                                <f:ajax listener="#{product.namedChanged}" render="input"/>

                            </h:inputText>
                        </div>
                        <h:message for="input"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">Increase</f:facet>
                        <div style="text-align: center">
                            <h:commandButton value="+" action="#{product.inc()}">
                                <f:ajax execute="form" render="form"/>
                            </h:commandButton>
                        </div>
                    </h:column>
                    <h:column>

                        <f:facet name="header">Already Ordered?
                        </f:facet>
                        <div style="text-align: center">
                            <h:selectBooleanCheckbox disabled="#{!product.isGroupAdmin()}" value="#{p.ordered}"/>
                        </div>
                    </h:column>
                    <h:column rendered="#{!product.isEmpty()}">
                        <f:facet name="header">DELETE?</f:facet>
                        <div style="text-align: center">
                            <h:commandButton value="DELETE" disabled="#{!product.isGroupAdmin()}"
                                             action="#{product.delete()}">
                                <f:ajax execute="form" render="form"/>
                            </h:commandButton>
                        </div>
                    </h:column>

                </h:dataTable>
                <div style="margin-top: 5%;margin-bottom: 5%">
                    <h:commandButton style=" margin: 0;position: absolute;left: 50%;-ms-transform: translate(-50%, -50%);
  transform: translate(-50%, -50%);" id="save" value="Save" action="#{product.save()}"
                                     binding="#{product.saveButton}">
                        <f:ajax execute="@form" render="@form"/>

                    </h:commandButton>
                </div>


            </h:form>
            <h:message for="save"/>


            <h:form style="border-top: black 1px solid;margin-top: 10%">
                <div style="text-align: center">
                    <h:outputText style="font-weight: bold" value="Create new Product:">

                    </h:outputText>


                </div>

                <h:dataTable columnClasses="columnNP" value="#{product.newProductModel}" var="nP"
                             style="width: 100%;margin: auto;margin-top:20px;"

                >
                    <h:column>
                        <f:facet name="header">Name
                        </f:facet>
                        <div style="text-align: center">
                            <h:inputText styleClass="ui-inputfield" value="#{nP.name}" id="createName"
                            >

                            </h:inputText>
                        </div>
                    </h:column>

                    <h:column>
                        <f:facet name="header">Description
                        </f:facet>
                        <div style="text-align: center">
                            <h:inputText styleClass="ui-inputfield" value="#{nP.description}" id="createDescription"
                            >

                            </h:inputText>
                        </div>
                    </h:column>
                    <h:column>
                        <f:facet name="header">Stock
                        </f:facet>
                        <div style="text-align: center">
                            <h:inputText styleClass="ui-inputfield" value="#{nP.count}" id="createStock"
                            >

                            </h:inputText>
                        </div>
                    </h:column>


                </h:dataTable>
                <div style="margin-top: 1%;text-align: center">
                    <h:commandButton style="margin-bottom: 1%" value="Create"
                                     action="#{product.createProduct()}">
                        <f:ajax render="form" execute="@form"/>
                        <f:param name="gID" value="#{product.groupDTO.gID}"/>
                    </h:commandButton>

                </div>
            </h:form>
            <h:form>


                <h:outputLink value="#{product.toGroupManager()}" rendered="#{product.isGroupAdmin()}"
                              style="margin-bottom: 5px;margin-left: 5px">
                    Manage Group
                </h:outputLink>
            </h:form>





        </div>


    </ui:define>
</ui:composition>